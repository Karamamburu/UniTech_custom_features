<!-- /goal_settings/goal_setting_col/goal_settting_col.html -->

<link href="../../style_lpe.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="goal_settings/goal_setting_col/goal_settting_col.css">
<link rel="stylesheet" type="text/css" href="/custom/dx_grid/dx.light.css" />
<script src="/custom/dx_grid/dx.all.js"></script>
<script src="/custom/dx_grid/dx.messages.ru.js"></script>
<div id="goalmap_info"></div>
<div class="viewport">
    <div class="viewport-header">
        <div class="main-header">Цели и результаты сотрудника - </div>
        <select id="year_selector" class="year-select">
            <!-- <option>2023</option>
            <option>2022</option> -->
        </select>
        <div class="year_selector_tip">Выбери год из списка</div>
        <div class="viewport-header-buttons">
            <div id="button_export_pdf" class="pdf-export-button" onclick="exportToPDF()">
                <div class="icon_pdf"></div>
                <span>Экспорт в PDF</span>
            </div>
        </div>
    </div>
    <div class="viewport-col-info">
        <div class="viewport-col-info-row">
            <div class="col-info-header-body">
                <div class="col-info-header">ФИО сотрудника:</div>
                <div id="col_info_fullname" class="col-info"></div>
            </div>
            <div class="col-info-header-body">
                <div class="col-info-header">Должность:</div>
                <div class="col-info-content">
                    <div id="col_info_position" class="col-info"></div>
                    <button class="edit-button" onclick="editPositionDialog()">
                        <svg version="1.1" id="Слой_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 16 16" style="enable-background:new 0 0 16 16;" xml:space="preserve">
                            <g>
                                <g>
                                    <path fill="#BDC6E0" d="M15.3,14.6H0.7c-0.3,0-0.5,0.3-0.5,0.5c0,0.3,0.3,0.5,0.5,0.5h14.7c0.3,0,0.5-0.3,0.5-0.5C15.9,14.8,15.7,14.6,15.3,14.6z
                                        "/>
                                    <path fill="#BDC6E0" d="M0.2,9.7l0,2.6c0,0.1,0.1,0.3,0.2,0.4c0.1,0.1,0.2,0.2,0.4,0.2l2.6,0c0.1,0,0.3-0.1,0.4-0.2l9-9c0.2-0.2,0.2-0.6,0-0.8
                                        l-2.6-2.6c-0.2-0.2-0.6-0.2-0.8,0L7.5,2.2L0.3,9.3C0.2,9.4,0.2,9.6,0.2,9.7z M9.7,1.5l1.8,1.8l-1,1L8.7,2.5
                                        C8.7,2.5,9.7,1.5,9.7,1.5z M1.3,9.9l6.6-6.6l1.8,1.8l-6.6,6.6l-1.8,0C1.3,11.8,1.3,9.9,1.3,9.9z"/>
                                </g>
                            </g>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="col-info-header-body">
                <div class="col-info-header">Подразделение:</div>
                <div id="col_info_subdivision" class="col-info"></div>
            </div>
        </div>
        <div class="viewport-col-info-row">
            <div class="col-info-header-body">
                <div class="col-info-header">Департамент:</div>
                <div id="col_info_department" class="col-info"></div>
            </div>
            <div class="col-info-header-body">
                <div class="col-info-header">Текущий статус:</div>
                <div id="goalmap_info_state_name" class="col-info"></div>
            </div>
            <div class="col-info-header-body">
                <div class="col-info-header">Согласующий руководитель:</div>
                <div class="col-info-content">
                    <div id="goalmap_info_manager_fullname" class="col-info"></div>
                    <button id="edit_mangaer" class="edit-button" onclick="editManagerDialog()">
                        <svg version="1.1" id="Слой_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 16 16" style="enable-background:new 0 0 16 16;" xml:space="preserve">
                            <g>
                                <g>
                                    <path fill="#BDC6E0" d="M15.3,14.6H0.7c-0.3,0-0.5,0.3-0.5,0.5c0,0.3,0.3,0.5,0.5,0.5h14.7c0.3,0,0.5-0.3,0.5-0.5C15.9,14.8,15.7,14.6,15.3,14.6z
                                        "/>
                                    <path fill="#BDC6E0" d="M0.2,9.7l0,2.6c0,0.1,0.1,0.3,0.2,0.4c0.1,0.1,0.2,0.2,0.4,0.2l2.6,0c0.1,0,0.3-0.1,0.4-0.2l9-9c0.2-0.2,0.2-0.6,0-0.8
                                        l-2.6-2.6c-0.2-0.2-0.6-0.2-0.8,0L7.5,2.2L0.3,9.3C0.2,9.4,0.2,9.6,0.2,9.7z M9.7,1.5l1.8,1.8l-1,1L8.7,2.5
                                        C8.7,2.5,9.7,1.5,9.7,1.5z M1.3,9.9l6.6-6.6l1.8,1.8l-6.6,6.6l-1.8,0C1.3,11.8,1.3,9.9,1.3,9.9z"/>
                                </g>
                            </g>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        <div class="viewport-col-info-row">
            <div class="col-info-header-body">
                <div class="col-info-header">Отображать неактуальные цели</div>
                <input type="checkbox" class="col-info-header" id="goalmap_irrelevant_check" >
            </div>
        </div>
        <!-- <div id="goalmap_info_comment_body" class="viewport-col-info-row" style="max-width: none;">
            <div class="col-info-header-body">
                <div class="col-info-header">Комментарий руководителя:</div>
                <div id="goalmap_info_comment" class="col-info"></div>
            </div>
        </div> -->
        <div class="viewport-col-info-row" id="col_comments_toggle">
            <div class="col-info-header-body">
                <div class="col-info-header">Показывать ленту комментариев</div>
                <input type="checkbox" class="col-info-header" id="ipr_comments_toggle" checked >
            </div>
        </div>
        <div id="col_info_comments_body" class="viewport-col-info-row" style="max-width: none;flex-direction: column;">
            <div class="col-info-header-body">
                <div class="col-info-header">Комментарии:</div>
            </div>
            <div class="ipr_comments_body">
                <!-- <div class="ipr_received_comment_body">
                    <div class="ipr_comment_header">Иванов Иван Иванович, 31.12.2023 10:48</div>
                    <div class="ipr_comment_message">Тестовый комментарий. Тестовый комментарий.</div>
                </div>
                <div class="ipr_sended_comment_body">
                    <div class="ipr_comment_header">31.12.2023 10:48</div>
                    <div class="ipr_comment_message">Тестовый комментарий. Тестовый комментарий.</div>
                </div>
                <div class="ipr_sended_comment_body">
                    <div class="ipr_comment_header">31.12.2023 10:48</div>
                    <div class="ipr_comment_message">Тестовый комментарий. Тестовый комментарий.</div>
                </div>
                <div class="ipr_sended_comment_body">
                    <div class="ipr_comment_header">31.12.2023 10:48</div>
                    <div class="ipr_comment_message">Тестовый комментарий. Тестовый комментарий.</div>
                </div>
                <div class="ipr_received_comment_body">
                    <div class="ipr_comment_header">Иванов Иван Иванович, 31.12.2023 10:48</div>
                    <div class="ipr_comment_message">Тестовый комментарий. Тестовый комментарий.</div>
                </div> -->
            </div>
        </div>
    </div>
    <div class="goals-body">
        <div id= "viewport-goals-header">
            <div id="tab-goals-header"></div>
            <button id="button_add_goal" class="goal-edit-button">+ Добавить</button>
        </div>

		<div id="goals"></div>
        <div id="okrs" style="display: none"></div>
        <div id="iprs" style="display: none"></div>
        <div id="gap" style="display: none"></div>
		<!--
        <div class="viewport-goals-header">
            <img src="https://academy.uni.rest/download_file.html?file_id=0x662A854833E1E247" width="16px">
            <div class="goals-main-header">Цели</div>
            <button id="button_add_goal" class="goal-edit-button" onclick="addGoalDialog()">+ Добавить</button>
        </div> -->
            <!-- <div class="goal">
                <div class="goal-header-body">
                    <div class="goal-header">
                        <div class="goal-header-text">Финансовая цель</div>
                    </div>
                    <button class="goal-edit-button">Редактировать</button>
                </div>
                <div class="goal-desc-body">
                    <div class="goal-desc" placeholder="Описание цели отсутствует."></div>
                    <div class="goal-plan-date">
                        <div class="goal-plan-date-header">Плановый срок:</div>
                        <div class="goal-plan-date-value">2023.12.12</div>
                    </div>
                </div>
                <div class="goal-result-header-body">
                    <div class="goal-header-result">
                        <div class="goal-header-text">Результат</div>
                    </div>
                    <button class="goal-edit-button">Редактировать</button>
                </div>
                <div class="goal-result-body">
                    <div class="goal-result" placeholder="Результат цели отсутствует.">
                        <div class="goal-result-main-header">1 полугодие</div>
                        <div class="goal-result-value-body">
                            <div class="goal-result-value-row">
                                <div class="goal-result-sub-header">Результат:</div>
                                <div class="goal-result-value">1 - ок</div>
                            </div>
                            <div class="goal-result-value-row">
                                <div class="goal-result-sub-header">Комментарий:</div>
                                <div class="goal-result-value">Какой-то длинный комментарий</div>
                            </div>
                        </div>
                        <div class="goal-result-main-header">2 полугодие</div>
                        <div class="goal-result-value-body">
                            <div class="goal-result-value-row">
                                <div class="goal-result-sub-header">Результат:</div>
                                <div class="goal-result-value">1 - ок</div>
                            </div>
                            <div class="goal-result-value-row">
                                <div class="goal-result-sub-header">Комментарий:</div>
                                <div class="goal-result-value">Какой-то длинный комментарий</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="goal">
                <div class="goal-header-body">
                    <div class="goal-header">
                        <div class="goal-header-text">Операционная цель</div>
                    </div>
                    <button class="goal-edit-button">Редактировать</button>
                </div>
                <div class="goal-desc-body">
                    <div class="goal-desc" placeholder="Описание цели отсутствует."></div>
                    <div class="goal-plan-date">
                        <div class="goal-plan-date-header">Плановый срок:</div>
                        <div class="goal-plan-date-value">2023.12.12</div>
                    </div>
                </div>
            </div>
            <div class="goal">
                <div class="goal-header-body">
                    <div class="goal-header">
                        <div class="goal-header-text">Цель по 4 Pillars</div>
                    </div>
                    <button class="goal-edit-button">Редактировать</button>
                </div>
                <div class="goal-desc-body">
                    <div class="goal-desc" placeholder="Описание цели отсутствует."></div>
                    <div class="goal-plan-date">
                        <div class="goal-plan-date-header">Плановый срок:</div>
                        <div class="goal-plan-date-value">2023.12.12</div>
                    </div>
                </div>
            </div>
            <div class="goal">
                <div class="goal-header-body">
                    <div class="goal-header">
                        <div class="goal-header-text">Цель по корпоративной культуре</div>
                    </div>
                    <button class="goal-edit-button">Редактировать</button>
                </div>
                <div class="goal-desc-body">
                    <div class="goal-desc" placeholder="Описание цели отсутствует."></div>
                    <div class="goal-plan-date">
                        <div class="goal-plan-date-header">Плановый срок:</div>
                        <div class="goal-plan-date-value">2023.12.12</div>
                    </div>
                </div>
            </div>
            <div class="goal">
                <div class="goal-header-body">
                    <div class="goal-header">
                        <div class="goal-header-text">Цель по развитию талантов</div>
                    </div>
                    <button class="goal-edit-button">Редактировать</button>
                </div>
                <div class="goal-desc-body">
                    <div class="goal-desc" placeholder="Описание цели отсутствует."></div>
                    <div class="goal-plan-date">
                        <div class="goal-plan-date-header">Плановый срок:</div>
                        <div class="goal-plan-date-value">2023.12.12</div>
                    </div>
                </div>
            </div>
            <div class="goal">
                <div class="goal-header-body">
                    <div class="goal-header">
                        <div class="goal-header-text">Обязательство по формированию атмосферы разнообразия и
                            инклюзивности в компании</div>
                    </div>
                    <button class="goal-edit-button">Редактировать</button>
                </div>
                <div class="goal-desc-body">
                    <div class="goal-desc" placeholder="Описание цели отсутствует."></div>
                    <div class="goal-plan-date">
                        <div class="goal-plan-date-header">Плановый срок:</div>
                        <div class="goal-plan-date-value">2023.12.12</div>
                    </div>
                </div>
            </div> -->
    <!--</div>
    <div class="goals-body">
        <div class="viewport-goals-header">
            <img src="https://academy.uni.rest/download_file.html?file_id=0x662A856717782569" width="16px">
            <div class="goals-main-header">Вклад в OKR</div>
            <button id="button_add_goal" class="goal-edit-button" onclick="addOKRDialog()">+ Добавить</button>
        </div>
        <div id="okrs"> -->
            <!-- <div class="goal">
                <div class="goal-header-body">
                    <div class="goal-header">
                        <div class="goal-header-text">Команда OKR</div>
                    </div>
                    <button class="goal-edit-button">Редактировать</button>
                </div>
                <div class="goal-desc-body">
                    <div class="goal-desc" placeholder="Описание цели отсутствует."></div>
                    <div class="goal-plan-date">
                        <div class="goal-plan-date-header">Плановый срок:</div>
                        <div class="goal-plan-date-value">2023.12.12</div>
                    </div>
                </div>
            </div> -->
       <!-- </div>
    </div> -->
    <!--<div class="goals-body">
        <div class="viewport-goals-header">
            <img src="https://academy.uni.rest/download_file.html?file_id=0x662A857A693AF067" width="16px">
            <div class="goals-main-header">Индивидуальный план развития</div>
            <button id="button_add_goal" class="goal-edit-button" onclick="addIPRDialog()">+ Добавить</button>
        </div>
        <div id="iprs"> -->
            <!-- <div class="goal">
                <div class="goal-header-body">
                    <div class="goal-header">
                        <div class="goal-header-text">ИНДИВИДУАЛЬНЫЙ ПЛАН РАЗВИТИЯ</div>
                    </div>
                    <button class="goal-edit-button">Редактировать</button>
                </div>
                <div class="goal-desc-body">
                    <div class="goal-desc" placeholder="Обязательное для заполнения поле"></div>
                    <div class="goal-plan-date">
                        <div class="goal-plan-date-header">Плановый срок:</div>
                        <div class="goal-plan-date-value">2023.12.12</div>
                    </div>
                </div>
            </div> -->
        <!--</div>
    </div> -->
    <div id="viewport_buttons" class="goals-body" style="border-radius: 0 0 0.8rem 0.8rem;">
        <div id="buttons" class="buttons">
            <button id="send_to_approve_button_on_edit_desc" class="confirm-button" onclick="sendToApproveDialog()">Отправить на согласование руководителю</button>
			<button id="send_to_approve_button_on_edit_result_main" class="confirm-button" onclick="sendToApproveDialog()">Отправить результаты на согласование руководителю</button>
            <button id="cancel_send_to_approve_button" class="confirm-button" onclick="cancelSendToApprove()">Отозвать</button>
            <button id="approve_button" class="confirm-button" onclick="approveDialog()">Подтвердить</button>
            <button id="return_to_work_button" class="confirm-button" onclick="returnToWorkDialog()">Вернуть на доработку</button>
            <button id="confirm" class="confirm-button" onclick="confirm()">Подтвердить ознакомление</button>
        </div>
    </div>
</div>

<div id="dialog_background_overlay" class="dialog-background-overlay" style="display: none;"></div>
<div id="collaborator_id" style="display: none;"><%=OptInt(Request.Query.GetOptProperty('col_id'), curUserID)%></div>
<div id="goalmap_id" style="display: none;"><%=OptInt(Request.Query.GetOptProperty('goalmap_id'), 0)%></div>
<div id="user_id" style="display: none;"><%=curUserID%></div>

<script src="goal_settings/goal_setting_col/goal_settting_col.js"></script>

<script>
    jQuery(function ($) {
        $("[contenteditable]").focusout(function () {
            var element = $(this);
            if (!element.text().trim().length) {
                element.empty();
            }
        });
    });
</script>